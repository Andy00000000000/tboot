<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Exponential Tilting Simulations • tboot</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Exponential Tilting Simulations">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">tboot</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/tboot.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/exp_tilting.html">Exponential Tilting Simulations</a>
    </li>
    <li>
      <a href="../articles/tboot_bmr.html">Gettings Started with Bayesian Marginal Reconstruction</a>
    </li>
    <li>
      <a href="../articles/tboot_bmr_vs_joint_bayes.html">Bayesian Marginal Reconstruction Simulations</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/nmorris-lilly/tboot">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Exponential Tilting Simulations</h1>
                        <h4 class="author">Nathan Morris, Lanfeng Pan</h4>
            
            <h4 class="date">2020-06-16</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/nmorris-lilly/tboot/blob/master/vignettes/exp_tilting.Rmd"><code>vignettes/exp_tilting.Rmd</code></a></small>
      <div class="hidden name"><code>exp_tilting.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>The most common type of bootstrap <span class="citation">(Efron 1981)</span> is to sample from the empirical distribution derived from observed data. Such samples will be distributed with the same mean as the observed data. But if the goal is to obtain samples that satisfying certain conditions on the moments while still being otherwise similar to the observed data, samples from the observed data must be drawn with unequal probability. The exponentially tilted bootstrap <span class="citation">(Johns 1988)</span> is one approach to defining an unequal propability for drawing each observed sample.</p>
<p>Denote the observed data as <span class="math inline">\(X_n=\{x_1, \ldots, x_n\}\)</span> with <span class="math inline">\(x_i\)</span> a vector of length <span class="math inline">\(p\)</span> and assume <span class="math inline">\(x_i\)</span> is drawn from a distribution <span class="math inline">\(f_{\theta}(x)\)</span> with parameters <span class="math inline">\(\theta\)</span>. The tilted bootstrap approach will draw samples with replacement from <span class="math inline">\(X_n\)</span> where the probability of selecting the <span class="math inline">\(i^{th}\)</span> sample is <span class="math inline">\(p_i = exp(\lambda \cdot x_i)/C_1\)</span> where <span class="math inline">\(\lambda\)</span> is some vector and <span class="math inline">\(C_1\)</span> is a normalizing constant.</p>
<p>We would expect that as <span class="math inline">\(n\)</span> increases the exponential tilted bootstrap distribution will become similar to the distribution <span class="math inline">\(g(x)=f_{\theta}(x) exp(\lambda \cdot x) / C_2\)</span> where <span class="math inline">\(C_2\)</span> is a normalizing constant. We show from the brief simulations below that this hypotheis is empirically correct. Theoretical derivations of the resulting distribution from exponetial tilting may be found in <span class="citation">(Fuh, Teng, and Wang 2013)</span> and <span class="citation">(Asmussen and Glynn 2007)</span>.</p>
</div>
<div id="simulations" class="section level1">
<h1 class="hasAnchor">
<a href="#simulations" class="anchor"></a>Simulations</h1>
<div id="simulation-1-exponential-family-density" class="section level2">
<h2 class="hasAnchor">
<a href="#simulation-1-exponential-family-density" class="anchor"></a>Simulation 1: exponential family density</h2>
<p>We simulate 1000 data points from Gaussian distribution <span class="math inline">\(N(\mu, 1)\)</span> for <span class="math inline">\(\mu\)</span> equals 0.25,0.5,0.75 and 1.5 respectively. We then use tboot to exponentially tilt the simulated data such that the means mean is at 0. To see the resulted distribution after tilting, we draw 1e4 bootstrap samples from the generated data points with probability equal to the tilted weight and then run kernel density estimation on each of the bootstrap samples. The nonparametric kernel density of the tilted distribution is given in parallel with the true density in the plot below. As may be see the tilted samples maintain the same variance (i.e., variance is 1) while shifting the expected mean to 0. This is expected based on theoretical considerations as exponentially tilting a normal distributions leads to changing the mean but not the variance.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"></a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Random">set.seed</a></span>(<span class="dv">2018</span>)</a>
<a class="sourceLine" id="cb1-3" data-line-number="3">def.par &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/par">par</a></span>(<span class="dt">no.readonly =</span> <span class="ot">TRUE</span>) <span class="co"># save default, for resetting...</span></a>
<a class="sourceLine" id="cb1-4" data-line-number="4"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/layout">layout</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/matrix">matrix</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>), <span class="dv">2</span>, <span class="dv">2</span>, <span class="dt">byrow =</span> <span class="ot">TRUE</span>))</a>
<a class="sourceLine" id="cb1-5" data-line-number="5"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/par">par</a></span>(<span class="dt">mai =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(.<span class="dv">45</span>,.<span class="dv">45</span>,.<span class="dv">25</span>,.<span class="dv">25</span>))</a>
<a class="sourceLine" id="cb1-6" data-line-number="6"><span class="cf">for</span>(bias <span class="cf">in</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="fl">0.25</span>, <span class="fl">.5</span>, <span class="fl">0.75</span>, <span class="fl">1.5</span>)){</a>
<a class="sourceLine" id="cb1-7" data-line-number="7">  X =<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/data.frame">data.frame</a></span>(<span class="dt">X=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Normal">rnorm</a></span>(<span class="fl">1e5</span>, bias))</a>
<a class="sourceLine" id="cb1-8" data-line-number="8">  w =<span class="st"> </span><span class="kw"><a href="../reference/tweights.html">tweights</a></span>(X, <span class="dt">target =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dt">X=</span><span class="dv">0</span>), <span class="dt">silent=</span>T)</a>
<a class="sourceLine" id="cb1-9" data-line-number="9">  Xb =<span class="st"> </span><span class="kw"><a href="../reference/tboot.html">tboot</a></span>(<span class="fl">1e5</span>, <span class="dt">weights =</span> w)</a>
<a class="sourceLine" id="cb1-10" data-line-number="10">  den =<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/density">density</a></span>(Xb<span class="op">$</span>X, <span class="dt">bw=</span>.<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1-11" data-line-number="11">  <span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/curve">curve</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Normal">dnorm</a></span>(x), <span class="dt">from =</span> <span class="dv">-4</span>, <span class="dt">to =</span> <span class="dv">4</span>, <span class="dt">col=</span><span class="st">"red"</span>, <span class="dt">lwd=</span><span class="dv">3</span>, <span class="dt">ylim=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">0</span>,<span class="fl">0.48</span>), <span class="dt">ylab=</span><span class="st">"density"</span>)</a>
<a class="sourceLine" id="cb1-12" data-line-number="12">  <span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/lines">lines</a></span>(den,<span class="dt">lwd=</span><span class="dv">3</span>, <span class="dt">col=</span><span class="st">"black"</span>, <span class="dt">lty=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1-13" data-line-number="13">  <span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/curve">curve</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Normal">dnorm</a></span>(x,<span class="dt">mean =</span> bias), <span class="dt">add=</span>T, <span class="dt">col =</span> <span class="st">"blue"</span>, <span class="dt">lty=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1-14" data-line-number="14"></a>
<a class="sourceLine" id="cb1-15" data-line-number="15">}</a></code></pre></div>
<div class="figure" style="text-align: center">
<img src="exp_tilting_files/figure-html/unnamed-chunk-2-1.png" alt="The blue dashed line is the density generating the original data.  The black dashed line is the kernel density on the tilted bootstrap samples. The yellow line is the standard normal density. The mean of the true density are 0.25, 0.5, 0.75, 1.5 respectively. This figure shows the tilted bootstrap samples match the target distribution very closely." width="576"><p class="caption">
The blue dashed line is the density generating the original data. The black dashed line is the kernel density on the tilted bootstrap samples. The yellow line is the standard normal density. The mean of the true density are 0.25, 0.5, 0.75, 1.5 respectively. This figure shows the tilted bootstrap samples match the target distribution very closely.
</p>
</div>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"></a>
<a class="sourceLine" id="cb2-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/par">par</a></span>(def.par)</a></code></pre></div>
</div>
<div id="simulation-2-gaussian-mixture" class="section level2">
<h2 class="hasAnchor">
<a href="#simulation-2-gaussian-mixture" class="anchor"></a>Simulation 2: Gaussian Mixture</h2>
<p>The tilted Gaussian mixture is still a Gaussian mixture with new means and new priors.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Random">set.seed</a></span>(<span class="dv">2018</span>)</a>
<a class="sourceLine" id="cb3-2" data-line-number="2">def.par &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/par">par</a></span>(<span class="dt">no.readonly =</span> <span class="ot">TRUE</span>) <span class="co"># save default, for resetting...</span></a>
<a class="sourceLine" id="cb3-3" data-line-number="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/layout">layout</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/matrix">matrix</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>), <span class="dv">2</span>, <span class="dv">2</span>, <span class="dt">byrow =</span> <span class="ot">TRUE</span>))</a>
<a class="sourceLine" id="cb3-4" data-line-number="4"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/par">par</a></span>(<span class="dt">mai =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(.<span class="dv">45</span>,.<span class="dv">45</span>,.<span class="dv">25</span>,.<span class="dv">25</span>))</a>
<a class="sourceLine" id="cb3-5" data-line-number="5"><span class="cf">for</span>(bias <span class="cf">in</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="fl">0.25</span>, <span class="fl">.5</span>, <span class="fl">0.75</span>, <span class="fl">2.2</span>)){</a>
<a class="sourceLine" id="cb3-6" data-line-number="6">  cand1 =<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Normal">rnorm</a></span>(<span class="fl">1e5</span>, bias<span class="dv">-2</span>)</a>
<a class="sourceLine" id="cb3-7" data-line-number="7">  cand2 =<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Normal">rnorm</a></span>(<span class="fl">1e5</span>, bias<span class="op">+</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb3-8" data-line-number="8">  X =<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/data.frame">data.frame</a></span>( <span class="dt">X=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/ifelse">ifelse</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Uniform">runif</a></span>(<span class="fl">1e5</span>)<span class="op">&lt;</span><span class="st"> </span><span class="fl">0.4</span>, cand1, cand2) )</a>
<a class="sourceLine" id="cb3-9" data-line-number="9">  <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/colnames">colnames</a></span>(X) =<span class="st"> "X"</span></a>
<a class="sourceLine" id="cb3-10" data-line-number="10">  w =<span class="st"> </span><span class="kw"><a href="../reference/tweights.html">tweights</a></span>(X, <span class="dt">target =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dt">X=</span><span class="dv">0</span>), <span class="dt">silent=</span>T)</a>
<a class="sourceLine" id="cb3-11" data-line-number="11">  </a>
<a class="sourceLine" id="cb3-12" data-line-number="12">  <span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/curve">curve</a></span>(<span class="fl">0.4</span> <span class="op">*</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Normal">dnorm</a></span>(x, <span class="dt">mean=</span>bias<span class="dv">-2</span>)<span class="op">+</span><span class="st"> </span><span class="fl">0.6</span><span class="op">*</span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Normal">dnorm</a></span>(x, <span class="dt">mean=</span>bias<span class="op">+</span><span class="dv">2</span>),</a>
<a class="sourceLine" id="cb3-13" data-line-number="13">        <span class="dt">from =</span> <span class="dv">-5</span>, <span class="dt">to =</span> <span class="dv">6</span>, <span class="dt">col=</span><span class="st">"blue"</span>, <span class="dt">lty=</span><span class="dv">2</span>, <span class="dt">ylim=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">0</span>,<span class="fl">0.32</span>), <span class="dt">ylab=</span><span class="st">"density"</span>)</a>
<a class="sourceLine" id="cb3-14" data-line-number="14">  Xb =<span class="st"> </span><span class="kw"><a href="../reference/tboot.html">tboot</a></span>(<span class="fl">1e5</span>, <span class="dt">weights =</span> w)</a>
<a class="sourceLine" id="cb3-15" data-line-number="15">  den =<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/density">density</a></span>(Xb<span class="op">$</span>X, <span class="dt">bw=</span>.<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb3-16" data-line-number="16">  <span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/lines">lines</a></span>(den, <span class="dt">lwd=</span><span class="dv">3</span>, <span class="dt">col=</span><span class="st">"black"</span>, <span class="dt">lty=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb3-17" data-line-number="17">}</a></code></pre></div>
<div class="figure" style="text-align: center">
<img src="exp_tilting_files/figure-html/unnamed-chunk-3-1.png" alt="The generating density is Gaussian mixture 0.4N(mu-2, 1)+0.6N(mu+2,1), marked as blue dashed lines. The kernel density of the  bootstrap samples are marked as dached black lines. The four figures correspond to using exponential tilting to fix mu=0.25, 0.5, 0.75 and 1.5 respectively." width="576"><p class="caption">
The generating density is Gaussian mixture 0.4N(mu-2, 1)+0.6N(mu+2,1), marked as blue dashed lines. The kernel density of the bootstrap samples are marked as dached black lines. The four figures correspond to using exponential tilting to fix mu=0.25, 0.5, 0.75 and 1.5 respectively.
</p>
</div>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"></a>
<a class="sourceLine" id="cb4-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/par">par</a></span>(def.par)</a></code></pre></div>
<p>To demonstrate this, we generate data points from <span class="math inline">\(0.4N(\mu-2, 1)+0.6N(\mu+2,1)\)</span> and align the mean to be 0 using exponential tilting. The above plots shows the kernel density plot of the tilted distribution.</p>
</div>
<div id="simulation-3-multivariate-gaussian-with-some-of-the-means-being-fixed" class="section level2">
<h2 class="hasAnchor">
<a href="#simulation-3-multivariate-gaussian-with-some-of-the-means-being-fixed" class="anchor"></a>Simulation 3: Multivariate Gaussian with some of the means being fixed</h2>
<p>Consider that <span class="math inline">\(\boldsymbol{X}=(\boldsymbol{X}_1,\boldsymbol{X}_2)\)</span>multivariate Gaussian distribution with mean <span class="math inline">\(\boldsymbol{\mu}=(\boldsymbol{\mu}_1,\boldsymbol{\mu}_2)\)</span> and variance <span class="math display">\[\boldsymbol{\Sigma}=\left[ {\begin{array}{cc}
   \boldsymbol{\Sigma}_{11} &amp; \boldsymbol{\Sigma}_{12} \\
   \boldsymbol{\Sigma}_{21} &amp; \boldsymbol{\Sigma}_{22} \\
  \end{array} } \right].
  \]</span></p>
<p>If aligning the means of <span class="math inline">\(\boldsymbol{X}_1\)</span> at certain values (say <span class="math inline">\(x_1\)</span>) using exponential tilting, the expectation of means of <span class="math inline">\(\boldsymbol{X}_2\)</span> are equal to the conditional mean: <span class="math display">\[
E\{\boldsymbol{X}_2 \mid \boldsymbol{X}_1=\boldsymbol{x}_1\}=\boldsymbol{\mu}_2 +\Sigma_{21}\Sigma_{11}^{-1}(x_1-\boldsymbol{\mu}_1)
\]</span> while the covariance remains unchanged (i.e. the covariance is <span class="math inline">\(\boldsymbol{\Sigma}_{22}\)</span> and not the conditional covariance). This theoretical result is demonstrated empirically using the simulation below.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Random">set.seed</a></span>(<span class="dv">2018</span>)</a>
<a class="sourceLine" id="cb5-2" data-line-number="2">mu =<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rep">rep</a></span>(<span class="dv">0</span>,<span class="dv">6</span>)</a>
<a class="sourceLine" id="cb5-3" data-line-number="3">Sig =<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/diag">diag</a></span>(<span class="dv">6</span>)</a>
<a class="sourceLine" id="cb5-4" data-line-number="4">rho =<span class="st"> </span><span class="fl">0.8</span></a>
<a class="sourceLine" id="cb5-5" data-line-number="5"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">6</span>){</a>
<a class="sourceLine" id="cb5-6" data-line-number="6">  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">6</span>){</a>
<a class="sourceLine" id="cb5-7" data-line-number="7">    Sig[i, j ] =<span class="st"> </span>rho<span class="op">^</span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/MathFun">abs</a></span>(i<span class="op">-</span>j) )</a>
<a class="sourceLine" id="cb5-8" data-line-number="8">  }</a>
<a class="sourceLine" id="cb5-9" data-line-number="9">}</a>
<a class="sourceLine" id="cb5-10" data-line-number="10"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/names">names</a></span>(mu)=<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/colnames">colnames</a></span>(Sig)=<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/colnames">rownames</a></span>(Sig)=<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste0</a></span>(<span class="st">"X"</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>)</a>
<a class="sourceLine" id="cb5-11" data-line-number="11"></a>
<a class="sourceLine" id="cb5-12" data-line-number="12"></a>
<a class="sourceLine" id="cb5-13" data-line-number="13">mu2_cond =<span class="st"> </span>(mu[<span class="dv">5</span><span class="op">:</span><span class="dv">6</span>] <span class="op">+</span><span class="st"> </span>Sig[<span class="dv">5</span><span class="op">:</span><span class="dv">6</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>] <span class="op">%*%</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/solve">solve</a></span>(Sig[<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>]) <span class="op">%*%</span><span class="st"> </span>(<span class="fl">0.5</span><span class="op">-</span>mu[<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>]))</a>
<a class="sourceLine" id="cb5-14" data-line-number="14">S22_cond =<span class="st"> </span>Sig[<span class="dv">5</span><span class="op">:</span><span class="dv">6</span>, <span class="dv">5</span><span class="op">:</span><span class="dv">6</span>] <span class="op">-</span><span class="st"> </span>Sig[<span class="dv">5</span><span class="op">:</span><span class="dv">6</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>] <span class="op">%*%</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/solve">solve</a></span>(Sig[<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>]) <span class="op">%*%</span><span class="st"> </span>Sig[<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>, <span class="dv">5</span><span class="op">:</span><span class="dv">6</span>]</a>
<a class="sourceLine" id="cb5-15" data-line-number="15">S22=Sig[<span class="dv">4</span><span class="op">:</span><span class="dv">6</span>, <span class="dv">4</span><span class="op">:</span><span class="dv">6</span>] </a>
<a class="sourceLine" id="cb5-16" data-line-number="16"></a>
<a class="sourceLine" id="cb5-17" data-line-number="17"></a>
<a class="sourceLine" id="cb5-18" data-line-number="18">X =<span class="st"> </span>MASS<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/MASS/topics/mvrnorm">mvrnorm</a></span>(<span class="dt">n =</span> <span class="fl">1e6</span>, <span class="dt">mu =</span> mu, <span class="dt">Sigma =</span> Sig)</a>
<a class="sourceLine" id="cb5-19" data-line-number="19"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/colnames">colnames</a></span>(X) =<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste0</a></span>(<span class="st">"X"</span>,<span class="dv">1</span><span class="op">:</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/nrow">ncol</a></span>(X))</a>
<a class="sourceLine" id="cb5-20" data-line-number="20">w =<span class="st"> </span><span class="kw"><a href="../reference/tweights.html">tweights</a></span>(X, <span class="dt">target =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dt">X1=</span>.<span class="dv">5</span>, <span class="dt">X2=</span>.<span class="dv">5</span>, <span class="dt">X3=</span>.<span class="dv">5</span>, <span class="dt">X4=</span>.<span class="dv">5</span>), <span class="dt">silent=</span>T)</a>
<a class="sourceLine" id="cb5-21" data-line-number="21">boots =<span class="st"> </span><span class="kw"><a href="../reference/tboot.html">tboot</a></span>(<span class="fl">1e6</span>, w)</a>
<a class="sourceLine" id="cb5-22" data-line-number="22">myMeans=<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/cbind">rbind</a></span>( mu[<span class="dv">5</span><span class="op">:</span><span class="dv">6</span>],</a>
<a class="sourceLine" id="cb5-23" data-line-number="23">               <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/t">t</a></span>(mu2_cond),</a>
<a class="sourceLine" id="cb5-24" data-line-number="24">              <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/colSums">colMeans</a></span>(boots[,<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"X5"</span>,<span class="st">"X6"</span>)]))</a>
<a class="sourceLine" id="cb5-25" data-line-number="25"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/colnames">rownames</a></span>(myMeans)=<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"Theoretical Data Mean"</span>,</a>
<a class="sourceLine" id="cb5-26" data-line-number="26">                    <span class="st">"Theoretical Data Conditional Mean"</span>, </a>
<a class="sourceLine" id="cb5-27" data-line-number="27">                    <span class="st">"Simulated Exponentially Tilted Mean"</span>)</a>
<a class="sourceLine" id="cb5-28" data-line-number="28">myMeltVar=<span class="cf">function</span>(V) </a>
<a class="sourceLine" id="cb5-29" data-line-number="29">  <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"Var(X5)"</span>=V[<span class="dv">1</span>,<span class="dv">1</span>], <span class="st">"Cov(X5,X6)"</span>=V[<span class="dv">1</span>,<span class="dv">2</span>], <span class="st">"Var(X6)"</span>=V[<span class="dv">2</span>,<span class="dv">2</span>])</a>
<a class="sourceLine" id="cb5-30" data-line-number="30"></a>
<a class="sourceLine" id="cb5-31" data-line-number="31">myVar=<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/cbind">rbind</a></span>(<span class="kw">myMeltVar</span>(S22),</a>
<a class="sourceLine" id="cb5-32" data-line-number="32">            <span class="kw">myMeltVar</span>(S22_cond),</a>
<a class="sourceLine" id="cb5-33" data-line-number="33">            <span class="kw">myMeltVar</span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/cor">cov</a></span>(boots[,<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"X5"</span>,<span class="st">"X6"</span>)])))</a>
<a class="sourceLine" id="cb5-34" data-line-number="34"></a>
<a class="sourceLine" id="cb5-35" data-line-number="35"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/colnames">rownames</a></span>(myVar)=<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"Theoretical Data Var/Cov"</span>,</a>
<a class="sourceLine" id="cb5-36" data-line-number="36">                  <span class="st">"Theoretical Data Conditional Var/Cov"</span>, </a>
<a class="sourceLine" id="cb5-37" data-line-number="37">                  <span class="st">"Simulated Exponentially Tilted Var/Cov"</span>)</a>
<a class="sourceLine" id="cb5-38" data-line-number="38">myMeans</a>
<a class="sourceLine" id="cb5-39" data-line-number="39"><span class="co">#&gt;                                            X5        X6</span></a>
<a class="sourceLine" id="cb5-40" data-line-number="40"><span class="co">#&gt; Theoretical Data Mean               0.0000000 0.0000000</span></a>
<a class="sourceLine" id="cb5-41" data-line-number="41"><span class="co">#&gt; Theoretical Data Conditional Mean   0.4000000 0.3200000</span></a>
<a class="sourceLine" id="cb5-42" data-line-number="42"><span class="co">#&gt; Simulated Exponentially Tilted Mean 0.3996611 0.3181786</span></a>
<a class="sourceLine" id="cb5-43" data-line-number="43"></a>
<a class="sourceLine" id="cb5-44" data-line-number="44">myVar</a>
<a class="sourceLine" id="cb5-45" data-line-number="45"><span class="co">#&gt;                                         Var(X5) Cov(X5,X6)   Var(X6)</span></a>
<a class="sourceLine" id="cb5-46" data-line-number="46"><span class="co">#&gt; Theoretical Data Var/Cov               1.000000   0.800000 1.0000000</span></a>
<a class="sourceLine" id="cb5-47" data-line-number="47"><span class="co">#&gt; Theoretical Data Conditional Var/Cov   0.360000   0.288000 0.5904000</span></a>
<a class="sourceLine" id="cb5-48" data-line-number="48"><span class="co">#&gt; Simulated Exponentially Tilted Var/Cov 1.002547   0.801528 0.9991947</span></a></code></pre></div>
</div>
</div>
<div id="references" class="section level1 unnumbered">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h1>
<div id="refs" class="references">
<div id="ref-asmussen2007stochastic">
<p>Asmussen, Søren, and Peter W Glynn. 2007. <em>Stochastic Simulation: Algorithms and Analysis</em>. Vol. 57. Springer Science &amp; Business Media.</p>
</div>
<div id="ref-efron1981nonparametric">
<p>Efron, Bradley. 1981. “Nonparametric Standard Errors and Confidence Intervals.” <em>Canadian Journal of Statistics</em> 9 (2). Wiley Online Library: 139–58.</p>
</div>
<div id="ref-fuh2013efficient">
<p>Fuh, Cheng-Der, Huei-Wen Teng, and Ren-Her Wang. 2013. “Efficient Importance Sampling for Rare Event Simulation with Applications.” <em>arXiv Preprint arXiv:1302.0583</em>.</p>
</div>
<div id="ref-johns1988">
<p>Johns, M. Vernon. 1988. “Importance Sampling for Bootstrap Confidence Intervals.” <em>Journal of the American Statistical Association</em> 83 (403). [American Statistical Association, Taylor &amp; Francis, Ltd.]: 709–14. <a href="http://www.jstor.org/stable/2289294">http://www.jstor.org/stable/2289294</a>.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#introduction">Introduction</a></li>
      <li>
<a href="#simulations">Simulations</a><ul class="nav nav-pills nav-stacked">
<li><a href="#simulation-1-exponential-family-density">Simulation 1: exponential family density</a></li>
      <li><a href="#simulation-2-gaussian-mixture">Simulation 2: Gaussian Mixture</a></li>
      <li><a href="#simulation-3-multivariate-gaussian-with-some-of-the-means-being-fixed">Simulation 3: Multivariate Gaussian with some of the means being fixed</a></li>
      </ul>
</li>
      <li><a href="#references">References</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Nathan Morris, William Michael Landau.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
